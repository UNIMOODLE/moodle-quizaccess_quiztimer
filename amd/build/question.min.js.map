{"version":3,"file":"question.min.js","sources":["../src/question.js"],"sourcesContent":["define(function(require, exports, module) {\n    'use strict';\n\n    var init = function(data) {\n        var attemptid = data.attemptid;\n        var tiempos = data.tiempos;\n\n        const backgroundColors = [\"#ca3120\", \"#d73422\", \"#dd3d2b\", \"#e04938\",\n            \"#e25546\", \"#e46153\", \"#e66d60\", \"#e8796d\", \"#ea867a\", \"#ec9288\",\n            \"#ee9e95\", \"#f0aaa2\", \"#f2b6af\", \"#f4c2bc\", \"#f7ceca\", \"#f9dad7\", \"#fbe6e4\"];\n\n        const textColors = [\"#fff\", \"#fff\", \"#fff\", \"#fff\", \"#fff\", \"#fff\",\n            \"#fff\", \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\",\n            \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\"];\n\n        //Disable original timer\n        var divElement = document.getElementById(\"quiz-timer\");\n        if (divElement) {\n            divElement.disabled = true;\n            divElement.innerHTML = \"Timer disabled\";\n        }\n\n        var quizTimerWrapper = document.getElementById(\"quiz-timer-wrapper\");\n        if (quizTimerWrapper.style.display === \"flex\") {\n        quizTimerWrapper.style.display = \"\";\n        }\n\n        var currentPageURL = window.location.href;\n        var urlParams = new URLSearchParams(currentPageURL);\n        var pageID = urlParams.get(\"page\");\n\n\n        if (pageID === null) {\n            pageID = 0;\n        }\n\n        var countdownID = \"countdown\" + pageID;\n        var quiztimercountdown = document.createElement('div');\n        quiztimercountdown.id = countdownID;\n        quiztimercountdown.className = 'countdown-question';\n\n        quiztimercountdown.style.maxWidth = \"max-content\";\n        quiztimercountdown.style.marginLeft = \"auto\";\n\n        var existingDiv = document.querySelector('.container-fluid.tertiary-navigation');\n        if (existingDiv) {\n            existingDiv.parentNode.insertBefore(quiztimercountdown, existingDiv.nextSibling);\n        }\n\n        var headingElement = document.querySelectorAll(\".container-fluid.tertiary-navigation\");\n\n        /**\n         * Updates the countdown timer based on the end time.\n         *\n         * @param {number} endTime - The end time of the countdown timer in seconds.\n         */\n        function updateCountdownTimer(endTime) {\n            var countdownElement = document.getElementById(\"countdown\" + (pageID));\n            var countdownInterval = setInterval(function() {\n                var currentTime = Math.floor(Date.now() / 1000);\n                var timeRemaining = (endTime - 1) - currentTime;\n\n                var totalDuration = endTime - (endTime - 1);\n                var currentPercentage = (timeRemaining / totalDuration) * 10;\n                countdownElement.style.backgroundColor = backgroundColors[currentPercentage];\n                countdownElement.style.color = textColors[currentPercentage];\n\n                if (timeRemaining <= -1 ) {\n                    clearInterval(countdownInterval);\n                    var button = document.getElementById(\"mod_quiz-next-nav\");\n                    localStorage.setItem(\"countdown\" + pageID, 0);\n                    countdownElement.innerHTML = \"00:00:00\";\n                    countdownElement.disabled = true;\n                    button.click();\n                    return;\n                } else {\n                    var button = document.getElementById(\"mod_quiz-next-nav\");\n                    if (button) {\n                        button.addEventListener(\"click\", function() {\n                            localStorage.setItem(\"countdown\" + pageID, timeRemaining);\n                        });\n                    }\n                }\n\n                function saveCountdownTime() {\n                    localStorage.setItem(\"countdown\" + pageID, timeRemaining);\n                    localStorage.setItem(\"attempt\", attemptid);\n                }\n\n                window.addEventListener(\"beforeunload\", saveCountdownTime);\n\n                var hours = Math.floor(timeRemaining / 3600);\n                var minutes = Math.floor((timeRemaining % 3600) / 60);\n                var seconds = timeRemaining % 60;\n\n                var formattedTime = hours.toString().padStart(2, \"0\") + \":\" +\n                                    minutes.toString().padStart(2, \"0\") + \":\" +\n                                    seconds.toString().padStart(2, \"0\");\n                countdownElement.innerHTML = formattedTime;\n                }, 1);\n        }\n\n        var endTime = tiempos[pageID] + Math.floor(Date.now() / 1000);\n\n        var storedTime = localStorage.getItem(\"countdown\" + pageID);\n        if (storedTime !== null) {\n            endTime = parseInt(storedTime) + Math.floor(Date.now() / 1000);\n            localStorage.removeItem(\"countdown\" + pageID);\n        }\n\n        updateCountdownTimer(endTime + 1, 5);\n\n        headingElement.forEach(function(headingElement, index) {\n            var textoElement = document.getElementById(\"countdown\" + (index));\n            if (headingElement && textoElement) {\n                headingElement.appendChild(textoElement);\n            }\n        });\n    };\n\n    return {\n        init: init\n    };\n});\n"],"names":["define","require","exports","module","init","data","attemptid","tiempos","backgroundColors","textColors","divElement","document","getElementById","disabled","innerHTML","quizTimerWrapper","style","display","currentPageURL","window","location","href","pageID","URLSearchParams","get","countdownID","quiztimercountdown","createElement","id","className","maxWidth","marginLeft","existingDiv","querySelector","parentNode","insertBefore","nextSibling","headingElement","querySelectorAll","endTime","Math","floor","Date","now","storedTime","localStorage","getItem","parseInt","removeItem","countdownElement","countdownInterval","setInterval","currentTime","timeRemaining","currentPercentage","backgroundColor","color","clearInterval","button","setItem","click","addEventListener","hours","minutes","seconds","formattedTime","toString","padStart","updateCountdownTimer","forEach","index","textoElement","appendChild"],"mappings":"AAAAA,wCAAO,SAASC,QAASC,QAASC,QAwH9B,MAAO,CACHC,KAtHO,SAASC,MAChB,IAAIC,UAAYD,KAAKC,UACjBC,QAAUF,KAAKE,QAEnB,MAAMC,iBAAmB,CAAC,UAAW,UAAW,UAAW,UACvD,UAAW,UAAW,UAAW,UAAW,UAAW,UACvD,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAEhEC,WAAa,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxD,OAAQ,UAAW,UAAW,UAAW,UACzC,UAAW,UAAW,UAAW,UAAW,UAAW,WAG3D,IAAIC,WAAaC,SAASC,eAAe,cACrCF,aACAA,WAAWG,UAAW,EACtBH,WAAWI,UAAY,kBAG3B,IAAIC,iBAAmBJ,SAASC,eAAe,sBACR,SAAnCG,iBAAiBC,MAAMC,UAC3BF,iBAAiBC,MAAMC,QAAU,IAGjC,IAAIC,eAAiBC,OAAOC,SAASC,KAEjCC,OADY,IAAIC,gBAAgBL,gBACbM,IAAI,QAGZ,OAAXF,SACAA,OAAS,GAGb,IAAIG,YAAc,YAAcH,OAC5BI,mBAAqBf,SAASgB,cAAc,OAChDD,mBAAmBE,GAAKH,YACxBC,mBAAmBG,UAAY,qBAE/BH,mBAAmBV,MAAMc,SAAW,cACpCJ,mBAAmBV,MAAMe,WAAa,OAEtC,IAAIC,YAAcrB,SAASsB,cAAc,wCACrCD,aACAA,YAAYE,WAAWC,aAAaT,mBAAoBM,YAAYI,aAGxE,IAAIC,eAAiB1B,SAAS2B,iBAAiB,wCAqD/C,IAAIC,QAAUhC,QAAQe,QAAUkB,KAAKC,MAAMC,KAAKC,MAAQ,KAEpDC,WAAaC,aAAaC,QAAQ,YAAcxB,QACjC,OAAfsB,aACAL,QAAUQ,SAASH,YAAcJ,KAAKC,MAAMC,KAAKC,MAAQ,KACzDE,aAAaG,WAAW,YAAc1B,SAnD1C,SAA8BiB,SAC1B,IAAIU,iBAAmBtC,SAASC,eAAe,YAAeU,QAC1D4B,kBAAoBC,aAAY,WAChC,IAAIC,YAAcZ,KAAKC,MAAMC,KAAKC,MAAQ,KACtCU,cAAiBd,QAAU,EAAKa,YAGhCE,kBAAqBD,eADLd,SAAWA,QAAU,IACiB,GAI1D,GAHAU,iBAAiBjC,MAAMuC,gBAAkB/C,iBAAiB8C,mBAC1DL,iBAAiBjC,MAAMwC,MAAQ/C,WAAW6C,mBAEtCD,gBAAkB,EAAI,CACtBI,cAAcP,mBACd,IAAIQ,OAAS/C,SAASC,eAAe,qBAKrC,OAJAiC,aAAac,QAAQ,YAAcrC,OAAQ,GAC3C2B,iBAAiBnC,UAAY,WAC7BmC,iBAAiBpC,UAAW,OAC5B6C,OAAOE,SAGHF,OAAS/C,SAASC,eAAe,uBAEjC8C,OAAOG,iBAAiB,SAAS,WAC7BhB,aAAac,QAAQ,YAAcrC,OAAQ+B,kBAUvDlC,OAAO0C,iBAAiB,gBALxB,WACIhB,aAAac,QAAQ,YAAcrC,OAAQ+B,eAC3CR,aAAac,QAAQ,UAAWrD,cAKpC,IAAIwD,MAAQtB,KAAKC,MAAMY,cAAgB,MACnCU,QAAUvB,KAAKC,MAAOY,cAAgB,KAAQ,IAC9CW,QAAUX,cAAgB,GAE1BY,cAAgBH,MAAMI,WAAWC,SAAS,EAAG,KAAO,IACpCJ,QAAQG,WAAWC,SAAS,EAAG,KAAO,IACtCH,QAAQE,WAAWC,SAAS,EAAG,KACnDlB,iBAAiBnC,UAAYmD,gBAC1B,GAWXG,CAAqB7B,QAAU,GAE/BF,eAAegC,SAAQ,SAAShC,eAAgBiC,OAC5C,IAAIC,aAAe5D,SAASC,eAAe,YAAe0D,OACtDjC,gBAAkBkC,cAClBlC,eAAemC,YAAYD,kBAQ3C"}