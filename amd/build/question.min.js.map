{"version":3,"file":"question.min.js","sources":["../src/question.js"],"sourcesContent":["define(function(require, exports, module) {\n    'use strict';\n\n    var init = function(data) {\n        var attemptid = data.attemptid;\n        var tiempos = data.tiempos;\n\n        const backgroundColors = [\"#ca3120\", \"#d73422\", \"#dd3d2b\", \"#e04938\",\n            \"#e25546\", \"#e46153\", \"#e66d60\", \"#e8796d\", \"#ea867a\", \"#ec9288\",\n            \"#ee9e95\", \"#f0aaa2\", \"#f2b6af\", \"#f4c2bc\", \"#f7ceca\", \"#f9dad7\", \"#fbe6e4\"];\n\n        const textColors = [\"#fff\", \"#fff\", \"#fff\", \"#fff\", \"#fff\", \"#fff\",\n            \"#fff\", \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\",\n            \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\", \"#1d2125\"];\n\n        //Disable original timer\n        var divElement = document.getElementById(\"quiz-timer\");\n        if (divElement) {\n            divElement.disabled = true;\n            divElement.innerHTML = \"Timer disabled\";\n        }\n\n        var currentPageURL = window.location.href;\n        var urlParams = new URLSearchParams(currentPageURL);\n        var pageID = urlParams.get(\"page\");\n\n\n        if (pageID === null) {\n            pageID = 0;\n        }\n\n        var countdownID = \"countdown\" + pageID;\n        var quiztimercountdown = document.createElement('div');\n        quiztimercountdown.id = countdownID;\n        quiztimercountdown.className = 'countdown-question';\n\n        quiztimercountdown.style.maxWidth = \"max-content\";\n        quiztimercountdown.style.marginLeft = \"auto\";\n\n        var existingDiv = document.querySelector('.container-fluid.tertiary-navigation');\n        if (existingDiv) {\n            existingDiv.parentNode.insertBefore(quiztimercountdown, existingDiv.nextSibling);\n        }\n\n        var headingElement = document.querySelectorAll(\".container-fluid.tertiary-navigation\");\n\n        /**\n         * Updates the countdown timer based on the end time.\n         *\n         * @param {number} endTime - The end time of the countdown timer in seconds.\n         */\n        function updateCountdownTimer(endTime) {\n            var countdownElement = document.getElementById(\"countdown\" + (pageID));\n            var countdownInterval = setInterval(function() {\n                var currentTime = Math.floor(Date.now() / 1000);\n                var timeRemaining = (endTime - 1) - currentTime;\n\n                var totalDuration = endTime - (endTime - 1);\n                var currentPercentage = (timeRemaining / totalDuration) * 10;\n                countdownElement.style.backgroundColor = backgroundColors[currentPercentage];\n                countdownElement.style.color = textColors[currentPercentage];\n\n                if (timeRemaining <= -1 ) {\n                    clearInterval(countdownInterval);\n                    var button = document.getElementById(\"mod_quiz-next-nav\");\n                    localStorage.setItem(\"countdown\" + pageID, 0);\n                    countdownElement.innerHTML = \"00:00:00\";\n                    countdownElement.disabled = true;\n                    button.click();\n                    return;\n                } else {\n                    var button = document.getElementById(\"mod_quiz-next-nav\");\n                    if (button) {\n                        button.addEventListener(\"click\", function() {\n                            localStorage.setItem(\"countdown\" + pageID, timeRemaining);\n                        });\n                    }\n                }\n\n                function saveCountdownTime() {\n                    localStorage.setItem(\"countdown\" + pageID, timeRemaining);\n                    localStorage.setItem(\"attempt\", attemptid);\n                }\n\n                window.addEventListener(\"beforeunload\", saveCountdownTime);\n\n                var hours = Math.floor(timeRemaining / 3600);\n                var minutes = Math.floor((timeRemaining % 3600) / 60);\n                var seconds = timeRemaining % 60;\n\n                var formattedTime = hours.toString().padStart(2, \"0\") + \":\" +\n                                    minutes.toString().padStart(2, \"0\") + \":\" +\n                                    seconds.toString().padStart(2, \"0\");\n                countdownElement.innerHTML = formattedTime;\n                }, 1);\n        }\n\n        var endTime = tiempos[pageID] + Math.floor(Date.now() / 1000);\n\n        var storedTime = localStorage.getItem(\"countdown\" + pageID);\n        if (storedTime !== null) {\n            endTime = parseInt(storedTime) + Math.floor(Date.now() / 1000);\n            localStorage.removeItem(\"countdown\" + pageID);\n        }\n\n        updateCountdownTimer(endTime + 1, 5);\n\n        headingElement.forEach(function(headingElement, index) {\n            var textoElement = document.getElementById(\"countdown\" + (index));\n            if (headingElement && textoElement) {\n                headingElement.appendChild(textoElement);\n            }\n        });\n    };\n\n    return {\n        init: init\n    };\n});\n"],"names":["define","require","exports","module","init","data","attemptid","tiempos","backgroundColors","textColors","divElement","document","getElementById","disabled","innerHTML","currentPageURL","window","location","href","pageID","URLSearchParams","get","countdownID","quiztimercountdown","createElement","id","className","style","maxWidth","marginLeft","existingDiv","querySelector","parentNode","insertBefore","nextSibling","headingElement","querySelectorAll","endTime","Math","floor","Date","now","storedTime","localStorage","getItem","parseInt","removeItem","countdownElement","countdownInterval","setInterval","currentTime","timeRemaining","currentPercentage","backgroundColor","color","clearInterval","button","setItem","click","addEventListener","hours","minutes","seconds","formattedTime","toString","padStart","updateCountdownTimer","forEach","index","textoElement","appendChild"],"mappings":"AAAAA,wCAAO,SAASC,QAASC,QAASC,cAmHvB,CACHC,KAjHO,SAASC,UACZC,UAAYD,KAAKC,UACjBC,QAAUF,KAAKE,cAEbC,iBAAmB,CAAC,UAAW,UAAW,UAAW,UACvD,UAAW,UAAW,UAAW,UAAW,UAAW,UACvD,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAEhEC,WAAa,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxD,OAAQ,UAAW,UAAW,UAAW,UACzC,UAAW,UAAW,UAAW,UAAW,UAAW,eAGvDC,WAAaC,SAASC,eAAe,cACrCF,aACAA,WAAWG,UAAW,EACtBH,WAAWI,UAAY,sBAGvBC,eAAiBC,OAAOC,SAASC,KAEjCC,OADY,IAAIC,gBAAgBL,gBACbM,IAAI,QAGZ,OAAXF,SACAA,OAAS,OAGTG,YAAc,YAAcH,OAC5BI,mBAAqBZ,SAASa,cAAc,OAChDD,mBAAmBE,GAAKH,YACxBC,mBAAmBG,UAAY,qBAE/BH,mBAAmBI,MAAMC,SAAW,cACpCL,mBAAmBI,MAAME,WAAa,WAElCC,YAAcnB,SAASoB,cAAc,wCACrCD,aACAA,YAAYE,WAAWC,aAAaV,mBAAoBO,YAAYI,iBAGpEC,eAAiBxB,SAASyB,iBAAiB,4CAqD3CC,QAAU9B,QAAQY,QAAUmB,KAAKC,MAAMC,KAAKC,MAAQ,KAEpDC,WAAaC,aAAaC,QAAQ,YAAczB,QACjC,OAAfuB,aACAL,QAAUQ,SAASH,YAAcJ,KAAKC,MAAMC,KAAKC,MAAQ,KACzDE,aAAaG,WAAW,YAAc3B,kBAnDZkB,aACtBU,iBAAmBpC,SAASC,eAAe,YAAeO,QAC1D6B,kBAAoBC,aAAY,eAC5BC,YAAcZ,KAAKC,MAAMC,KAAKC,MAAQ,KACtCU,cAAiBd,QAAU,EAAKa,YAGhCE,kBAAqBD,eADLd,SAAWA,QAAU,IACiB,MAC1DU,iBAAiBpB,MAAM0B,gBAAkB7C,iBAAiB4C,mBAC1DL,iBAAiBpB,MAAM2B,MAAQ7C,WAAW2C,mBAEtCD,gBAAkB,EAAI,CACtBI,cAAcP,uBACVQ,OAAS7C,SAASC,eAAe,4BACrC+B,aAAac,QAAQ,YAActC,OAAQ,GAC3C4B,iBAAiBjC,UAAY,WAC7BiC,iBAAiBlC,UAAW,OAC5B2C,OAAOE,SAGHF,OAAS7C,SAASC,eAAe,uBAEjC4C,OAAOG,iBAAiB,SAAS,WAC7BhB,aAAac,QAAQ,YAActC,OAAQgC,kBAUvDnC,OAAO2C,iBAAiB,2BAJpBhB,aAAac,QAAQ,YAActC,OAAQgC,eAC3CR,aAAac,QAAQ,UAAWnD,kBAKhCsD,MAAQtB,KAAKC,MAAMY,cAAgB,MACnCU,QAAUvB,KAAKC,MAAOY,cAAgB,KAAQ,IAC9CW,QAAUX,cAAgB,GAE1BY,cAAgBH,MAAMI,WAAWC,SAAS,EAAG,KAAO,IACpCJ,QAAQG,WAAWC,SAAS,EAAG,KAAO,IACtCH,QAAQE,WAAWC,SAAS,EAAG,KACnDlB,iBAAiBjC,UAAYiD,gBAC1B,GAWXG,CAAqB7B,QAAU,GAE/BF,eAAegC,SAAQ,SAAShC,eAAgBiC,WACxCC,aAAe1D,SAASC,eAAe,YAAewD,OACtDjC,gBAAkBkC,cAClBlC,eAAemC,YAAYD,kBAQ1C"}