{"version":3,"file":"page.min.js","sources":["../src/page.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n// Project implemented by the \\\"Recovery, Transformation and Resilience Plan.\n// Funded by the European Union - Next GenerationEU\\\".\n//\n// Produced by the UNIMOODLE University Group: Universities of\n// Valladolid, Complutense de Madrid, UPV/EHU, León, Salamanca,\n// Illes Balears, Valencia, Rey Juan Carlos, La Laguna, Zaragoza, Málaga,\n// Córdoba, Extremadura, Vigo, Las Palmas de Gran Canaria y Burgos.\n\n/**\n * Version details\n *\n * @package    quizaccess_quiztimer\n * @copyright  2023 Proyecto UNIMOODLE\n * @author     UNIMOODLE Group (Coordinator) <direccion.area.estrategia.digital@uva.es>\n * @author     ISYC <soporte@isyc.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(function() {\n    'use strict';\n\n    var init = function(data) {\n        var section = data.section;\n        var secondsleft = data.secondsleft;\n        var timefinish = Math.floor(Date.now() / 1000) + secondsleft;\n\n        // Disable original timer.\n        var divElement = document.getElementById(\"quiz-timer\");\n        if (divElement) {\n            divElement.disabled = true;\n            divElement.innerHTML = \"Timer disabled\";\n        }\n\n        var quizTimerWrapper = document.getElementById(\"quiz-timer-wrapper\");\n        if (quizTimerWrapper && quizTimerWrapper.style.display === \"flex\") {\n            quizTimerWrapper.style.display = \"\";\n        }\n\n        // Create the div for the timer.\n        var countdownID = \"countdown\" + section;\n        var quiztimercountdown = document.createElement('div');\n        quiztimercountdown.id = countdownID;\n        quiztimercountdown.className = 'quiztimer-countdown-section';\n        quiztimercountdown.style.maxWidth = \"max-content\";\n        quiztimercountdown.style.marginLeft = \"auto\";\n\n        var existingDiv = document.querySelector('.container-fluid.tertiary-navigation');\n        if (existingDiv) {\n            existingDiv.parentNode.insertBefore(quiztimercountdown, existingDiv.nextSibling);\n        }\n\n        var headingElement = document.querySelectorAll(\".container-fluid.tertiary-navigation\");\n\n        function updateCountdownTimer(endTime) {\n            var countdownElement = document.getElementById(countdownID);\n            var countdownInterval = setInterval(function() {\n                var currentTime = Math.floor(Date.now() / 1000);\n                var timeRemaining = endTime - currentTime;\n\n                if (timeRemaining <= 0) {\n                    clearInterval(countdownInterval);\n                    countdownElement.innerHTML = \"00:00:00\";\n                    countdownElement.disabled = true;\n\n                    var button = document.getElementById(\"mod_quiz-next-nav\");\n                    if (button) {\n                        button.click();\n                    }\n                    return;\n                }\n\n                var hours = Math.floor(timeRemaining / 3600);\n                var minutes = Math.floor((timeRemaining % 3600) / 60);\n                var seconds = timeRemaining % 60;\n\n                var formattedTime = hours.toString().padStart(2, \"0\") + \":\" +\n                                    minutes.toString().padStart(2, \"0\") + \":\" +\n                                    seconds.toString().padStart(2, \"0\");\n                countdownElement.innerHTML = formattedTime;\n            }, 1);\n        }\n\n        updateCountdownTimer(timefinish);\n\n        headingElement.forEach(function(heading) {\n            var textoElement = document.getElementById(\"countdown\" + section);\n            if (heading && textoElement) {\n                heading.appendChild(textoElement);\n            }\n        });\n    };\n\n    return {\n        init: init\n    };\n});\n"],"names":["define","init","data","section","secondsleft","timefinish","Math","floor","Date","now","divElement","document","getElementById","disabled","innerHTML","quizTimerWrapper","style","display","countdownID","quiztimercountdown","createElement","id","className","maxWidth","marginLeft","existingDiv","querySelector","parentNode","insertBefore","nextSibling","endTime","countdownElement","countdownInterval","headingElement","querySelectorAll","setInterval","currentTime","timeRemaining","clearInterval","button","click","hours","minutes","seconds","formattedTime","toString","padStart","forEach","heading","textoElement","appendChild"],"mappings":";;;;;;;;;AAgCAA,oCAAO,iBA0EI,CACHC,KAxEO,SAASC,UACZC,QAAUD,KAAKC,QACfC,YAAcF,KAAKE,YACnBC,WAAaC,KAAKC,MAAMC,KAAKC,MAAQ,KAAQL,YAG7CM,WAAaC,SAASC,eAAe,cACrCF,aACAA,WAAWG,UAAW,EACtBH,WAAWI,UAAY,sBAGvBC,iBAAmBJ,SAASC,eAAe,sBAC3CG,kBAAuD,SAAnCA,iBAAiBC,MAAMC,UAC3CF,iBAAiBC,MAAMC,QAAU,QAIjCC,YAAc,YAAcf,QAC5BgB,mBAAqBR,SAASS,cAAc,OAChDD,mBAAmBE,GAAKH,YACxBC,mBAAmBG,UAAY,8BAC/BH,mBAAmBH,MAAMO,SAAW,cACpCJ,mBAAmBH,MAAMQ,WAAa,WAElCC,YAAcd,SAASe,cAAc,wCACrCD,aACAA,YAAYE,WAAWC,aAAaT,mBAAoBM,YAAYI,iBAK1CC,QACtBC,iBACAC,kBAJJC,eAAiBtB,SAASuB,iBAAiB,wCAEjBJ,QA6BTzB,WA5Bb0B,iBAAmBpB,SAASC,eAAeM,aAC3Cc,kBAAoBG,aAAY,eAC5BC,YAAc9B,KAAKC,MAAMC,KAAKC,MAAQ,KACtC4B,cAAgBP,QAAUM,eAE1BC,eAAiB,GACjBC,cAAcN,mBACdD,iBAAiBjB,UAAY,WAC7BiB,iBAAiBlB,UAAW,MAExB0B,OAAS5B,SAASC,eAAe,qBACjC2B,QACAA,OAAOC,iBAKXC,MAAQnC,KAAKC,MAAM8B,cAAgB,MACnCK,QAAUpC,KAAKC,MAAO8B,cAAgB,KAAQ,IAC9CM,QAAUN,cAAgB,GAE1BO,cAAgBH,MAAMI,WAAWC,SAAS,EAAG,KAAO,IACpCJ,QAAQG,WAAWC,SAAS,EAAG,KAAO,IACtCH,QAAQE,WAAWC,SAAS,EAAG,KACnDf,iBAAiBjB,UAAY8B,iBAC9B,GAKPX,eAAec,SAAQ,SAASC,aACxBC,aAAetC,SAASC,eAAe,YAAcT,SACrD6C,SAAWC,cACXD,QAAQE,YAAYD"}